<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPP - Board de Gestão de Próprios Públicos</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <div class="logo">
            <i data-feather="tool"></i>
            <h1>BPP</h1>
            <h2 class="subtitle">Board de Gestão de Próprios Públicos</h2>
        </div>
        <div class="user-info">
            <div class="user-avatar">
                <i data-feather="user"></i>
            </div>
            <div class="user-details">
                <span class="user-name">João Silva</span>
                <span class="user-role">Chefe de Seção SAR03</span>
            </div>
            <div class="date">
                <i data-feather="calendar"></i>
                <span>24/05/2025</span>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab active" data-tab="dashboard">
                <i data-feather="bar-chart-2"></i>
                <span>Dashboard</span>
            </button>
            <button class="tab" data-tab="kanban">
                <i data-feather="trello"></i>
                <span>Kanban OS</span>
            </button>
            <button class="tab" data-tab="relatorios">
                <i data-feather="trending-up"></i>
                <span>Relatórios</span>
            </button>
            <button class="tab" data-tab="almoxarifado">
                <i data-feather="package"></i>
                <span>Almoxarifado</span>
            </button>
            <button class="tab" data-tab="fabrica">
                <i data-feather="settings"></i>
                <span>Fábrica</span>
            </button>
        </div>

        <!-- Floating Action Button for New OS -->
        <button class="fab" onclick="openModal('nova-os-modal')">
            <i data-feather="plus"></i>
        </button>

        <div class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <div class="page-header">
                    <h2>Dashboard</h2>
                    <p class="page-subtitle">Visão geral das ordens de serviço</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="file-text"></i>
                        </div>
                        <div class="stat-content">
                            <h3>47</h3>
                            <p>OS Abertas</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="eye"></i>
                        </div>
                        <div class="stat-content">
                            <h3>12</h3>
                            <p>Aguardando Vistoria</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="play-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>23</h3>
                            <p>Em Execução</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>156</h3>
                            <p>Finalizadas (Mês)</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>
                                <i data-feather="pie-chart"></i>
                                OS por Divisão
                            </h3>
                        </div>
                        <div class="card-content">
                            <div class="chart-item">
                                <div class="chart-info">
                                    <i data-feather="tool"></i>
                                    <span>SAR03.01 (Construção)</span>
                                    <strong>34 OS</strong>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 68%;"></div>
                                </div>
                            </div>
                            <div class="chart-item">
                                <div class="chart-info">
                                    <i data-feather="settings"></i>
                                    <span>SAR03.03 (Manutenção)</span>
                                    <strong>39 OS</strong>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 78%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3>
                                <i data-feather="clock"></i>
                                Tempo Médio por Divisão
                            </h3>
                        </div>
                        <div class="card-content">
                            <div class="time-item">
                                <div class="time-info">
                                    <i data-feather="users"></i>
                                    <strong>SAR03.01 (Construção)</strong>
                                    <span>Tempo médio: 6.8 dias</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 68%;"></div>
                                </div>
                            </div>
                            <div class="time-item">
                                <div class="time-info">
                                    <i data-feather="users"></i>
                                    <strong>SAR03.03 (Manutenção)</strong>
                                    <span>Tempo médio: 3.2 dias</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 32%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Kanban Tab -->
            <div id="kanban" class="tab-content">
                <div class="page-header">
                    <h2>Kanban - Fluxo de Ordens de Serviço</h2>
                    <p class="page-subtitle">Acompanhe o ciclo completo: SEI → OS → Vistoria → Execução → Fechamento</p>
                </div>
                
                <div class="kanban-board">
                    <div class="kanban-column">
                        <div class="kanban-header">
                            <div class="kanban-title">
                                <div class="status-indicator cadastradas"></div>
                                <h3>Recebidas do SEI</h3>
                            </div>
                            <div class="kanban-count">8</div>
                        </div>
                        
                        <div class="os-card" onclick="openModal('os-detail')">
                            <div class="sei-number">SEI: 1129.2025/0000916-7</div>
                            <div class="os-number">Aguardando OS</div>
                            <div class="os-title">Reparo de telhado</div>
                            <div class="os-location">
                                <i data-feather="map-pin"></i>
                                Escola Municipal Vila Galvão
                            </div>
                            <div class="os-requester">
                                <i data-feather="user"></i>
                                Maria Santos - Diretora
                            </div>
                            <div class="os-date">
                                <i data-feather="calendar"></i>
                                Recebido: 24/05/2025
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-primary" onclick="event.stopPropagation(); createOSFromSEI('1129.2025/0000916-7')">
                                    <i data-feather="plus"></i>
                                    Abrir OS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); downloadOSReportXLS('Aguardando OS', '1129.2025/0000916-7')" title="Baixar XLS - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="download"></i>
                                    XLS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); printOSReport('Aguardando OS', '1129.2025/0000916-7')" title="Imprimir - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="printer"></i>
                                    Imprimir
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="kanban-column">
                        <div class="kanban-header">
                            <div class="kanban-title">
                                <div class="status-indicator vistoria"></div>
                                <h3>Aguardando Vistoria</h3>
                            </div>
                            <div class="kanban-count">5</div>
                        </div>
                        
                        <div class="os-card" onclick="openModal('vistoria-modal')">
                            <div class="sei-number">SEI: 1129.2025/0000914-2</div>
                            <div class="os-number">OS #2025-0847</div>
                            <div class="os-title">Vazamento hidráulico</div>
                            <div class="os-location">
                                <i data-feather="map-pin"></i>
                                CEU Continental
                            </div>
                            <div class="os-requester">
                                <i data-feather="user"></i>
                                Ana Costa - Diretora CEU
                            </div>
                            <div class="os-date">
                                <i data-feather="calendar"></i>
                                Vistoria agendada: 25/05/2025
                            </div>
                            <div class="os-division">
                                <i data-feather="tool"></i>
                                SAR03.03 - Manutenção
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); downloadOSReportXLS('2025-0847', '1129.2025/0000914-2')" title="Baixar XLS - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="download"></i>
                                    XLS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); printOSReport('2025-0847', '1129.2025/0000914-2')" title="Imprimir - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="printer"></i>
                                    Imprimir
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="kanban-column">
                        <div class="kanban-header">
                            <div class="kanban-title">
                                <div class="status-indicator urgente"></div>
                                <h3>Urgentes</h3>
                            </div>
                            <div class="kanban-count">2</div>
                        </div>
                        
                        <div class="os-card">
                            <div class="sei-number">SEI: 1129.2025/0000910-1</div>
                            <div class="os-number">OS #2025-0845</div>
                            <div class="os-title">Curto-circuito quadro elétrico</div>
                            <div class="os-location">
                                <i data-feather="map-pin"></i>
                                UBS Vila Augusta
                            </div>
                            <div class="os-requester">
                                <i data-feather="user"></i>
                                Dr. Roberto Silva - Coordenador UBS
                            </div>
                            <div class="os-status urgent">
                                <i data-feather="alert-triangle"></i>
                                Risco de segurança - Custo: R$ 2.800,00
                            </div>
                            <div class="os-division">
                                <i data-feather="tool"></i>
                                SAR03.03 - Manutenção
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); downloadOSReportXLS('2025-0845', '1129.2025/0000910-1')" title="Baixar XLS - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="download"></i>
                                    XLS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); printOSReport('2025-0845', '1129.2025/0000910-1')" title="Imprimir - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="printer"></i>
                                    Imprimir
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="kanban-column">
                        <div class="kanban-header">
                            <div class="kanban-title">
                                <div class="status-indicator fila"></div>
                                <h3>Fila de Espera</h3>
                            </div>
                            <div class="kanban-count">12</div>
                        </div>
                        
                        <div class="os-card">
                            <div class="sei-number">SEI: 1129.2025/0000908-5</div>
                            <div class="os-number">OS #2025-0840</div>
                            <div class="os-title">Pintura de salas</div>
                            <div class="os-location">
                                <i data-feather="map-pin"></i>
                                EMEI Jardim São João
                            </div>
                            <div class="os-requester">
                                <i data-feather="user"></i>
                                Lucia Ferreira - Diretora EMEI
                            </div>
                            <div class="os-estimate">
                                <i data-feather="clock"></i>
                                Previsão: 15 dias - Custo: R$ 1.250,00
                            </div>
                            <div class="os-division">
                                <i data-feather="tool"></i>
                                SAR03.01 - Construção
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); downloadOSReportXLS('2025-0840', '1129.2025/0000908-5')" title="Baixar XLS - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="download"></i>
                                    XLS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); printOSReport('2025-0840', '1129.2025/0000908-5')" title="Imprimir - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="printer"></i>
                                    Imprimir
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="kanban-column">
                        <div class="kanban-header">
                            <div class="kanban-title">
                                <div class="status-indicator execucao"></div>
                                <h3>Em Execução</h3>
                            </div>
                            <div class="kanban-count">7</div>
                        </div>
                        
                        <div class="os-card" onclick="openModal('daily-report-modal')">
                            <div class="sei-number">SEI: 1129.2025/0000905-8</div>
                            <div class="os-number">OS #2025-0835</div>
                            <div class="os-title">Reforma do pátio</div>
                            <div class="os-location">
                                <i data-feather="map-pin"></i>
                                Escola Municipal Centro
                            </div>
                            <div class="os-requester">
                                <i data-feather="user"></i>
                                Paulo Santos - Diretor
                            </div>
                            <div class="os-progress">
                                <i data-feather="trending-up"></i>
                                Progresso: 60% - Custo: R$ 8.500,00
                            </div>
                            <div class="daily-report-status">
                                <i data-feather="check-circle"></i>
                                Relatório diário atualizado
                            </div>
                            <div class="os-division">
                                <i data-feather="tool"></i>
                                SAR03.01 - Construção
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); downloadOSReportXLS('2025-0835', '1129.2025/0000905-8')" title="Baixar XLS - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="download"></i>
                                    XLS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); printOSReport('2025-0835', '1129.2025/0000905-8')" title="Imprimir - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="printer"></i>
                                    Imprimir
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="kanban-column">
                        <div class="kanban-header">
                            <div class="kanban-title">
                                <div class="status-indicator concluido"></div>
                                <h3>Concluído</h3>
                            </div>
                            <div class="kanban-count">4</div>
                        </div>
                        
                        <div class="os-card" onclick="openModal('closing-modal')">
                            <div class="sei-number">SEI: 1129.2025/0000901-3</div>
                            <div class="os-number">OS #2025-0830</div>
                            <div class="os-title">Troca de portas</div>
                            <div class="os-location">
                                <i data-feather="map-pin"></i>
                                UBS Macedo
                            </div>
                            <div class="os-requester">
                                <i data-feather="user"></i>
                                Dra. Marina Costa - Coordenadora
                            </div>
                            <div class="os-completion">
                                <i data-feather="check-circle"></i>
                                Concluído em: 23/05/2025 - Custo Final: R$ 3.200,00
                            </div>
                            <div class="sei-status">
                                <i data-feather="file-text"></i>
                                Aguardando envio para SEI
                            </div>
                            <div class="os-division">
                                <i data-feather="tool"></i>
                                SAR03.03 - Manutenção
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); downloadOSReportXLS('2025-0830', '1129.2025/0000901-3')" title="Baixar XLS - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="download"></i>
                                    XLS
                                </button>
                                <button class="btn btn-secondary" onclick="event.stopPropagation(); printOSReport('2025-0830', '1129.2025/0000901-3')" title="Imprimir - Emissão: <span class='emit-date'></span>">
                                    <i data-feather="printer"></i>
                                    Imprimir
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Relatórios Tab -->
            <div id="relatorios" class="tab-content">
                <div class="page-header">
                    <h2>Relatórios</h2>
                    <p class="page-subtitle">Planilhas de controle e relatórios quadrimestrais</p>
                </div>

                <div class="reports-grid">
                    <div class="report-card">
                        <div class="report-header">
                            <h3>
                                <i data-feather="file-text"></i>
                                Relatórios de Ordens de Serviço
                            </h3>
                        </div>
                        <div class="report-content">
                            <div class="report-item" onclick="openSpreadsheet('construcao')">
                                <i data-feather="tool"></i>
                                <span>SAR03.01 - Construção</span>
                                <small>34 OS ativas</small>
                            </div>
                            <div class="report-item" onclick="openSpreadsheet('manutencao')">
                                <i data-feather="settings"></i>
                                <span>SAR03.03 - Manutenção</span>
                                <small>39 OS ativas</small>
                            </div>
                        </div>
                    </div>

                    <div class="report-card">
                        <div class="report-header">
                            <h3>
                                <i data-feather="package"></i>
                                Controle de Materiais
                            </h3>
                        </div>
                        <div class="report-content">
                            <div class="report-item" onclick="openSpreadsheet('almoxarifado')">
                                <i data-feather="archive"></i>
                                <span>Material do Almoxarifado</span>
                                <small>Controle de estoque</small>
                            </div>
                            <div class="report-item" onclick="openSpreadsheet('fabrica')">
                                <i data-feather="settings"></i>
                                <span>Produção da Fábrica</span>
                                <small>Pré-moldados</small>
                            </div>
                        </div>
                    </div>

                    <div class="report-card">
                        <div class="report-header">
                            <h3>
                                <i data-feather="bar-chart"></i>
                                Relatório Quadrimestral
                            </h3>
                        </div>
                        <div class="report-content">
                            <div class="quarter-stats">
                                <div class="stat">
                                    <span class="stat-label">OS Finalizadas</span>
                                    <span class="stat-value">156</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Material Consumido</span>
                                    <span class="stat-value">R$ 185.000</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Produção Fábrica</span>
                                    <span class="stat-value">2.340 peças</span>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="generateQuarterlyReport()">
                                <i data-feather="download"></i>
                                Gerar Relatório
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Almoxarifado Tab -->
            <div id="almoxarifado" class="tab-content">
                <div class="page-header">
                    <h2>Material do Almoxarifado</h2>
                    <p class="page-subtitle">Controle de estoque de materiais</p>
                </div>

                <div class="warehouse-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="alert-triangle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>8</h3>
                            <p>Itens Baixo Estoque</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="trending-up"></i>
                        </div>
                        <div class="stat-content">
                            <h3>125</h3>
                            <p>Movimentações (Mês)</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="package"></i>
                        </div>
                        <div class="stat-content">
                            <h3>R$ 45.000</h3>
                            <p>Total em Estoque</p>
                        </div>
                    </div>
                </div>

                <div class="warehouse-content">
                    <div class="warehouse-header">
                        <div class="search-bar">
                            <input type="text" placeholder="Buscar material...">
                            <button class="btn-icon">
                                <i data-feather="search"></i>
                            </button>
                        </div>
                        <button class="btn btn-primary" onclick="openModal('material-entry-modal')">
                            <i data-feather="plus"></i>
                            Nova Movimentação
                        </button>
                    </div>

                    <table class="warehouse-table">
                        <thead>
                            <tr>
                                <th>Material</th>
                                <th>Estoque Atual</th>
                                <th>Unidade</th>
                                <th>Status</th>
                                <th>Última Movimentação</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="low-stock">
                                <td>Cimento (saco 50kg)</td>
                                <td>15</td>
                                <td>UN</td>
                                <td><span class="status-badge critical">Crítico</span></td>
                                <td>24/05/2025</td>
                                <td>
                                    <button class="btn-icon" onclick="openMaterialDetail('cimento')">
                                        <i data-feather="eye"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>Areia (m³)</td>
                                <td>45</td>
                                <td>M³</td>
                                <td><span class="status-badge normal">Normal</span></td>
                                <td>23/05/2025</td>
                                <td>
                                    <button class="btn-icon" onclick="openMaterialDetail('areia')">
                                        <i data-feather="eye"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr class="low-stock">
                                <td>Tinta Branca (18L)</td>
                                <td>8</td>
                                <td>UN</td>
                                <td><span class="status-badge warning">Baixo</span></td>
                                <td>24/05/2025</td>
                                <td>
                                    <button class="btn-icon" onclick="openMaterialDetail('tinta')">
                                        <i data-feather="eye"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Fábrica Tab -->
            <div id="fabrica" class="tab-content">
                <div class="page-header">
                    <h2>Produção da Fábrica de Pré-moldados</h2>
                    <p class="page-subtitle">Controle de produção de materiais</p>
                </div>

                <div class="production-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="settings"></i>
                        </div>
                        <div class="stat-content">
                            <h3>156</h3>
                            <p>Peças Produzidas (Mês)</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3>12</h3>
                            <p>Dias de Produção</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i data-feather="trending-up"></i>
                        </div>
                        <div class="stat-content">
                            <h3>85%</h3>
                            <p>Eficiência</p>
                        </div>
                    </div>
                </div>

                <div class="production-content">
                    <div class="production-header">
                        <h3>Controle de Produção - Janeiro 2025</h3>
                        <button class="btn btn-primary" onclick="openModal('production-entry-modal')">
                            <i data-feather="plus"></i>
                            Registrar Produção
                        </button>
                    </div>

                    <div class="production-grid">
                        <div class="production-item">
                            <div class="production-info">
                                <h4>Bloco de Concreto</h4>
                                <span class="production-quantity">2.450 peças</span>
                                <span class="production-date">Janeiro 2025</span>
                            </div>
                            <div class="production-materials">
                                <span>Cimento: 85 sacos</span>
                                <span>Areia: 15 m³</span>
                                <span>Pedra: 12 m³</span>
                            </div>
                        </div>

                        <div class="production-item">
                            <div class="production-info">
                                <h4>Laje Pré-moldada</h4>
                                <span class="production-quantity">180 peças</span>
                                <span class="production-date">Janeiro 2025</span>
                            </div>
                            <div class="production-materials">
                                <span>Cimento: 45 sacos</span>
                                <span>Ferro: 2.5 t</span>
                                <span>Areia: 8 m³</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for New OS from SEI -->
    <div id="nova-os-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i data-feather="plus-circle"></i>
                    Nova Ordem de Serviço
                </h2>
                <button class="modal-close" onclick="closeModal('nova-os-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="nova-os-form" class="form-container">
                    <div class="form-section">
                        <h3>Informações da Solicitação SEI</h3>
                        <div class="form-group">
                            <label for="sei-number">
                                <i data-feather="file"></i>
                                Número do SEI *
                            </label>
                            <input type="text" id="sei-number" placeholder="Ex: 1129.2025/0000916-7" required>
                        </div>

                        <div class="form-group">
                            <label for="solicitante">
                                <i data-feather="user"></i>
                                Solicitante *
                            </label>
                            <input type="text" id="solicitante" placeholder="Nome completo" required>
                        </div>

                        <div class="form-group">
                            <label for="orgao">
                                <i data-feather="building"></i>
                                Órgão/Secretaria *
                            </label>
                            <select id="orgao" required>
                                <option value="">Selecione...</option>
                                <option value="educacao">Secretaria de Educação</option>
                                <option value="saude">Secretaria de Saúde</option>
                                <option value="cultura">Secretaria de Cultura</option>
                                <option value="sar">Secretaria de Adm. Regionais</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="local">
                                <i data-feather="map-pin"></i>
                                Local do Serviço *
                            </label>
                            <input type="text" id="local" placeholder="Ex: CEU Continental, UBS Centro..." required>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Dados da Ordem de Serviço</h3>
                        <div class="form-group">
                            <label for="divisao">
                                <i data-feather="users"></i>
                                Divisão Responsável *
                            </label>
                            <select id="divisao" required>
                                <option value="">Selecione...</option>
                                <option value="SAR03.01">SAR03.01 - Construção</option>
                                <option value="SAR03.03">SAR03.03 - Manutenção</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="tipo-servico">
                                <i data-feather="tool"></i>
                                Tipo de Serviço *
                            </label>
                            <select id="tipo-servico" onchange="showAISuggestions()" required>
                                <option value="">Selecione...</option>
                                <option value="hidraulica">Hidráulica</option>
                                <option value="eletrica">Elétrica</option>
                                <option value="pintura">Pintura</option>
                                <option value="carpintaria">Carpintaria</option>
                                <option value="serralheria">Serralheria</option>
                                <option value="alvenaria">Alvenaria</option>
                                <option value="telhado">Telhado</option>
                                <option value="limpeza">Limpeza</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="data-hora">
                                <i data-feather="calendar"></i>
                                Data e Hora da Abertura *
                            </label>
                            <input type="datetime-local" id="data-hora" required>
                        </div>

                        <div class="form-group">
                            <label for="descricao">
                                <i data-feather="edit-3"></i>
                                Descrição do Problema *
                            </label>
                            <textarea id="descricao" rows="4" placeholder="Descreva detalhadamente o problema encontrado..." required></textarea>
                        </div>

                        <div id="ai-suggestions" class="ai-suggestions" style="display: none;">
                            <div class="ai-header">
                                <i data-feather="cpu"></i>
                                <strong>Sugestões da Base de Conhecimento</strong>
                            </div>
                            <div id="suggestions-content">
                                <!-- Suggestions will be populated by JavaScript -->
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-primary" onclick="createOS(event)">
                                <i data-feather="check"></i>
                                Abrir Ordem de Serviço
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Vistoria (Technical Inspection) -->
    <div id="vistoria-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i data-feather="eye"></i>
                    Vistoria Técnica - OS #2025-0847
                </h2>
                <button class="modal-close" onclick="closeModal('vistoria-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="vistoria-info">
                    <div class="detail-grid">
                        <div class="detail-item">
                            <i data-feather="file"></i>
                            <div>
                                <strong>SEI</strong>
                                <span>1129.2025/0000914-2</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="map-pin"></i>
                            <div>
                                <strong>Local</strong>
                                <span>CEU Continental</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="user"></i>
                            <div>
                                <strong>Solicitante</strong>
                                <span>Ana Costa - Diretora CEU</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="tool"></i>
                            <div>
                                <strong>Tipo</strong>
                                <span>Vazamento hidráulico</span>
                            </div>
                        </div>
                    </div>
                </div>

                <form class="vistoria-form">
                    <div class="form-section">
                        <h3>Resultado da Vistoria</h3>
                        <div class="form-group">
                            <label for="custo-previo">
                                <i data-feather="dollar-sign"></i>
                                Custo Prévio *
                            </label>
                            <input type="number" id="custo-previo" placeholder="0,00" step="0.01" required>
                        </div>

                        <div class="form-group">
                            <label for="urgencia-vistoria">
                                <i data-feather="alert-triangle"></i>
                                Classificação *
                            </label>
                            <select id="urgencia-vistoria" required>
                                <option value="">Selecione...</option>
                                <option value="urgente">Urgente (risco/segurança)</option>
                                <option value="fila">Fila de espera</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="observacoes-vistoria">
                                <i data-feather="edit-3"></i>
                                Observações da Vistoria
                            </label>
                            <textarea id="observacoes-vistoria" rows="3" placeholder="Observações técnicas..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="materiais-necessarios">
                                <i data-feather="package"></i>
                                Materiais Necessários
                            </label>
                            <textarea id="materiais-necessarios" rows="3" placeholder="Liste os materiais necessários..."></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-primary" onclick="finishVistoria()">
                                <i data-feather="check"></i>
                                Finalizar Vistoria
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Daily Service Report -->
    <div id="daily-report-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i data-feather="clipboard"></i>
                    Relatório Diário de Serviço - OS #2025-0835
                </h2>
                <button class="modal-close" onclick="closeModal('daily-report-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="report-info">
                    <div class="detail-grid">
                        <div class="detail-item">
                            <i data-feather="file"></i>
                            <div>
                                <strong>SEI</strong>
                                <span>1129.2025/0000905-8</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="calendar"></i>
                            <div>
                                <strong>Data</strong>
                                <span>24/05/2025</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="map-pin"></i>
                            <div>
                                <strong>Local</strong>
                                <span>Escola Municipal Centro</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="users"></i>
                            <div>
                                <strong>Divisão</strong>
                                <span>SAR03.01 - Construção</span>
                            </div>
                        </div>
                    </div>
                </div>

                <form class="daily-report-form">
                    <div class="form-section">
                        <h3>Atividades do Dia</h3>
                        <div class="form-group">
                            <label for="atividades-realizadas">
                                <i data-feather="check-square"></i>
                                Atividades Realizadas *
                            </label>
                            <textarea id="atividades-realizadas" rows="4" placeholder="Descreva as atividades realizadas hoje..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="equipe-trabalho">
                                <i data-feather="users"></i>
                                Equipe de Trabalho
                            </label>
                            <div class="team-selection">
                                <div class="team-member">
                                    <input type="checkbox" id="joao-silva" checked>
                                    <label for="joao-silva">João Silva - Pedreiro</label>
                                </div>
                                <div class="team-member">
                                    <input type="checkbox" id="pedro-santos" checked>
                                    <label for="pedro-santos">Pedro Santos - Ajudante</label>
                                </div>
                                <div class="team-member">
                                    <input type="checkbox" id="carlos-oliveira">
                                    <label for="carlos-oliveira">Carlos Oliveira - Eletricista</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="materiais-utilizados">
                                <i data-feather="package"></i>
                                Materiais Utilizados
                            </label>
                            <div class="materials-section">
                                <div class="material-entry">
                                    <select class="material-select">
                                        <option value="">Selecionar material...</option>
                                        <option value="cimento">Cimento (saco 50kg)</option>
                                        <option value="areia">Areia (m³)</option>
                                        <option value="tijolo">Tijolo (milheiro)</option>
                                        <option value="tinta">Tinta (lata 18L)</option>
                                    </select>
                                    <input type="number" placeholder="Quantidade" class="material-quantity">
                                    <button type="button" class="btn-add-material" onclick="addMaterial()">
                                        <i data-feather="plus"></i>
                                    </button>
                                </div>
                                <div class="materials-list">
                                    <div class="material-item">
                                        <span>Cimento (saco 50kg) - 10 unidades</span>
                                        <button type="button" onclick="removeMaterial(this)">
                                            <i data-feather="trash-2"></i>
                                        </button>
                                    </div>
                                    <div class="material-item">
                                        <span>Areia (m³) - 2 unidades</span>
                                        <button type="button" onclick="removeMaterial(this)">
                                            <i data-feather="trash-2"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="progresso-estimado">
                                <i data-feather="trending-up"></i>
                                Progresso Estimado
                            </label>
                            <div class="progress-input">
                                <input type="range" id="progresso-range" min="0" max="100" value="60" oninput="updateProgress(this.value)">
                                <span id="progress-value">60%</span>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="observacoes-dia">
                                <i data-feather="alert-circle"></i>
                                Observações/Problemas
                            </label>
                            <textarea id="observacoes-dia" rows="3" placeholder="Registre observações ou problemas encontrados..."></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-primary" onclick="saveDailyReport()">
                                <i data-feather="save"></i>
                                Salvar Relatório
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for OS Closing -->
    <div id="closing-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i data-feather="check-circle"></i>
                    Fechamento de OS - #2025-0830
                </h2>
                <button class="modal-close" onclick="closeModal('closing-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="closing-info">
                    <div class="detail-grid">
                        <div class="detail-item">
                            <i data-feather="file"></i>
                            <div>
                                <strong>SEI</strong>
                                <span>1129.2025/0000901-3</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="calendar"></i>
                            <div>
                                <strong>Concluído em</strong>
                                <span>23/05/2025</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="dollar-sign"></i>
                            <div>
                                <strong>Custo Final</strong>
                                <span>R$ 3.200,00</span>
                            </div>
                        </div>
                        <div class="detail-item">
                            <i data-feather="users"></i>
                            <div>
                                <strong>Divisão</strong>
                                <span>SAR03.03 - Manutenção</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="closing-section">
                    <h3>Relatório Final de Materiais</h3>
                    <div class="materials-summary">
                        <div class="material-used">
                            <span>Portas de madeira - 3 unidades</span>
                            <span>R$ 1.800,00</span>
                        </div>
                        <div class="material-used">
                            <span>Dobradiças - 6 unidades</span>
                            <span>R$ 180,00</span>
                        </div>
                        <div class="material-used">
                            <span>Fechaduras - 3 unidades</span>
                            <span>R$ 450,00</span>
                        </div>
                        <div class="material-used">
                            <span>Mão de obra (3 dias)</span>
                            <span>R$ 770,00</span>
                        </div>
                        <div class="material-total">
                            <strong>Total: R$ 3.200,00</strong>
                        </div>
                    </div>
                </div>

                <div class="closing-section">
                    <h3>Fotos do Trabalho Concluído</h3>
                    <div class="photos-grid">
                        <div class="photo-item">
                            <div class="photo-placeholder">
                                <i data-feather="image"></i>
                                <span>Antes</span>
                            </div>
                        </div>
                        <div class="photo-item">
                            <div class="photo-placeholder">
                                <i data-feather="image"></i>
                                <span>Depois</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-primary" onclick="sendToSEI()">
                        <i data-feather="send"></i>
                        Enviar para SEI
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="generateMaterialReport()">
                        <i data-feather="file-text"></i>
                        Gerar Relatório de Materiais
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Material Entry -->
    <div id="material-entry-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i data-feather="package"></i>
                    Nova Movimentação - Almoxarifado
                </h2>
                <button class="modal-close" onclick="closeModal('material-entry-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form class="material-form">
                    <div class="form-section">
                        <div class="form-group">
                            <label for="movimento-tipo">
                                <i data-feather="arrow-right"></i>
                                Tipo de Movimento *
                            </label>
                            <select id="movimento-tipo" required>
                                <option value="">Selecione...</option>
                                <option value="entrada">Entrada</option>
                                <option value="saida">Saída</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="material-nome">
                                <i data-feather="package"></i>
                                Material *
                            </label>
                            <input type="text" id="material-nome" placeholder="Nome do material" required>
                        </div>

                        <div class="form-group">
                            <label for="quantidade-movimento">
                                <i data-feather="hash"></i>
                                Quantidade *
                            </label>
                            <input type="number" id="quantidade-movimento" placeholder="0" required>
                        </div>

                        <div class="form-group">
                            <label for="destino-origem">
                                <i data-feather="map-pin"></i>
                                Destino/Origem
                            </label>
                            <input type="text" id="destino-origem" placeholder="Para onde vai / De onde vem">
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-primary" onclick="saveMaterialMovement()">
                                <i data-feather="save"></i>
                                Registrar Movimento
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Production Entry -->
    <div id="production-entry-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i data-feather="settings"></i>
                    Registrar Produção - Fábrica
                </h2>
                <button class="modal-close" onclick="closeModal('production-entry-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form class="production-form">
                    <div class="form-section">
                        <div class="form-group">
                            <label for="produto-tipo">
                                <i data-feather="box"></i>
                                Tipo de Produto *
                            </label>
                            <select id="produto-tipo" required>
                                <option value="">Selecione...</option>
                                <option value="bloco">Bloco de Concreto</option>
                                <option value="laje">Laje Pré-moldada</option>
                                <option value="viga">Viga Pré-moldada</option>
                                <option value="tubo">Tubo de Concreto</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="quantidade-produzida">
                                <i data-feather="hash"></i>
                                Quantidade Produzida *
                            </label>
                            <input type="number" id="quantidade-produzida" placeholder="0" required>
                        </div>

                        <div class="form-group">
                            <label for="data-producao">
                                <i data-feather="calendar"></i>
                                Data da Produção *
                            </label>
                            <input type="date" id="data-producao" required>
                        </div>

                        <div class="form-group">
                            <label for="materiais-utilizados-producao">
                                <i data-feather="package"></i>
                                Materiais Utilizados
                            </label>
                            <textarea id="materiais-utilizados-producao" rows="3" placeholder="Ex: Cimento: 45 sacos, Areia: 8 m³..."></textarea>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-primary" onclick="saveProduction()">
                                <i data-feather="save"></i>
                                Registrar Produção
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal for Spreadsheet Viewer -->
    <div id="spreadsheet-modal" class="modal">
        <div class="modal-content" style="max-width: 90%; max-height: 90%;">
            <div class="modal-header">
                <h2>
                    <i data-feather="file-text"></i>
                    <span id="spreadsheet-title">Planilha</span>
                </h2>
                <div class="spreadsheet-actions">
                    <button class="btn btn-secondary" onclick="exportSpreadsheet()">
                        <i data-feather="download"></i>
                        Exportar XLS
                    </button>
                    <button class="btn btn-secondary" onclick="printSpreadsheet()">
                        <i data-feather="printer"></i>
                        Imprimir
                    </button>
                </div>
                <button class="modal-close" onclick="closeModal('spreadsheet-modal')">
                    <i data-feather="x"></i>
                </button>
            </div>
            
            <div class="modal-body" style="padding: 0;">
                <div id="spreadsheet-content" class="spreadsheet-viewer">
                    <!-- Spreadsheet content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>